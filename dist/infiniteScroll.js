(()=>{"use strict";document.getElementById("js_copy_site"),document.getElementById("js_copy_tag"),document.getElementById("tag_reference_id");const e=e=>{const t=`Fetch error: ${e.message}, Detailed error: ${e.stack}, ${new Date}`;fetch("/src/fetch/logErrorFetch.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},t=()=>{window.location.href="/error"};let n={domain_name:"",domain_category:"",domain_type:"",tag_type:"",copy_reference:"",tag_reference:"",copy_reference_id:"",original_domain_id:"null",tag_reference_id:"",domain_id:""};const a=e=>{const t=document.getElementById("js_create_btn"),a=n||o();if("edit"!=e){const e=Boolean(a.domain_name&&a.domain_category&&"original"==a.domain_type&&"new"===a.tag_type),n=Boolean(a.domain_name&&a.domain_category&&"original"==a.domain_type&&"reference"===a.tag_type&&a.tag_reference&&a.tag_reference_id),o=Boolean(a.domain_name&&a.domain_category&&("copy"===a.domain_type||"directory"===a.domain_type)&&"new"===a.tag_type&&a.copy_reference&&a.copy_reference_id&&a.original_domain_id),d=Boolean(a.domain_name&&a.domain_category&&("copy"===a.domain_type||"directory"===a.domain_type)&&"new"!==a.tag_type&&a.copy_reference&&a.copy_reference_id&&a.original_domain_id&&a.tag_reference&&a.tag_reference_id),i=Boolean(a.domain_name&&a.domain_category&&("copy"===a.domain_type||"directory"===a.domain_type)&&"withoutTag"===a.tag_type&&a.copy_reference&&a.copy_reference_id&&a.original_domain_id&&a.tag_reference&&a.tag_reference_id);t.classList.toggle("disabled_btn",!(e||o||d||n||i))}},o=()=>{const e=localStorage.getItem("data");return JSON.parse(e)},d=e=>{e.forEach((e=>{e.checked=!1})),a("add")},i=(e,t,n)=>{e.querySelector(".label").innerHTML=t,e.disabled=!0,document.getElementById(n).value="",a("add")},c=(document.getElementById("js_domain_add_modal"),document.getElementById("js_info_modal"),document.querySelector(".bg-gray")),r=(document.querySelector(".bg-gray2"),document.querySelector(".admin_modal_container")),l=e=>{const t=document.querySelectorAll(".js_selectedID"),o=document.querySelector(".js_isActive");document.getElementById("js_error").innerHTML="",n.copy_reference="",n.copy_reference_id="",n.original_domain_id="",a("add"),""===document.getElementById("js_error").innerHTML&&((()=>{const e=document.getElementById("domain_name"),t=document.querySelectorAll('input[name="type"]'),n=document.querySelectorAll('input[name="category"]'),a=document.querySelectorAll('input[name="tag_types"]'),o=document.getElementById("js_copy_site"),c=document.getElementById("js_copy_tag"),r=document.querySelectorAll(".js_tagCheck");e.value="",d(t),d(n),d(a),d(r),i(o,"コピーサイト参照先","js_copy_reference_id"),i(c,"タグ参照先","js_tag_reference_id"),document.querySelector(".cateogory_area").style.display="none";const l=document.querySelector(".tagInfo_area");"none"==l.style.display&&(l.style.display="block")})(),n.copy_reference="",n.copy_reference_id="",n.original_domain_id="",n.domain_category="",n.domain_name="",n.domain_type="",n.tag_reference="",n.tag_reference_id="",n.tag_type="",a("add")),a("add");let c=e.currentTarget,r=c.getAttribute("data-id");t.forEach((e=>{e.value=r})),o.value=c.getAttribute("data-id-active")},s=()=>{document.querySelectorAll(".edit_modal_btns").forEach((n=>{n.addEventListener("click",(n=>{l(n),(()=>{const n=document.querySelector(".js_selectedID").value;fetch("/src/fetch/checkTagID.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>{if(!e.ok)throw new Error("サーバーエラーが発生しました。");return e.json()})).then((e=>{const t=document.querySelector(".js_delete_tag").getElementsByTagName("p");if(e.length<=0){for(var n=0;n<t.length;n++)t[n].classList.remove("red"),t[n].style.color="rgba(255, 0, 0, 0.25)";const e=document.querySelector(".js_delete_tag").getElementsByTagName("img");for(n=0;n<e.length;n++)e[n].src="/public/img/trash_2.png";document.querySelector(".js_delete_tag").style.pointerEvents="none"}else{for(n=0;n<t.length;n++)t[n].style.color="red";const e=document.querySelector(".js_delete_tag").getElementsByTagName("img");for(n=0;n<e.length;n++)e[n].src="/public/img/trash.png";document.querySelector(".js_delete_tag").style.pointerEvents="auto"}})).catch((n=>{e(n),t()}))})(),(()=>{const n=document.querySelector(".js_selectedID").value;fetch("/src/fetch/checkCopySite.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>{if(!e.ok)throw new Error("サーバーエラーが発生しました。");return e.json()})).then((e=>{e.length>0?(()=>{const e=document.querySelector(".js_delete_domain");e.getElementsByTagName("p")[0].classList.remove("red"),e.getElementsByTagName("p")[0].style.color="rgba(255, 0, 0, 0.25)",e.getElementsByTagName("img")[0].src="/public/img/trash_2.png"})():(()=>{const e=document.querySelector(".js_delete_domain");e.getElementsByTagName("p")[0].classList.add("red"),e.getElementsByTagName("p")[0].style.color="red",e.getElementsByTagName("img")[0].src="/public/img/trash.png"})()})).catch((n=>{e(n),t()}))})(),"0"===document.querySelector(".js_isActive").value?(document.getElementById("active_check").innerHTML="使用する",document.getElementById("active_status").value="使用する"):document.getElementById("active_status").value="使用しない",setTimeout((()=>{r.classList.remove("hidden"),c.classList.remove("hidden")}),100)}))}))},_=e=>{let t="";return e.forEach((e=>{const n="0"===e.is_active?"red":"green",a="0"===e.is_active?"未使用":"使用",o="0"==e.random_domain_id?e.tag_reference_randomID:e.random_domain_id,d=`/showTag/?id=${e.id}`;t+=`<tr class="js_copySites">\n            <td class="domain_name align-middle" style="padding-left: 8%;"><img src="/public/img/folder.png" alt="" class="folder_icon"><a href="${d}" class="textdecoration_none">${e.domain_name}</a></td>\n            <td class="original_check align-middle"></td>\n            <td class="align-middle ${n}">${a}</td>\n            <td class="text_color align-middle">${o}</td>\n            <td class="text_color align-middle edit_modal_btns js_tables" data-id="${e.id}" data-id-active=${e.is_active}><i class="fas fa-ellipsis-v text_color"></i></td>                                 \n        </tr>\n        `})),t},m=document.querySelector(".js_btn");let g=1;document.querySelectorAll(".js_categories").forEach((e=>{e.addEventListener("click",(()=>{document.querySelector(".js_btn").innerHTML="もっと表示させる",g=1}))})),m.addEventListener("click",(()=>{y(g),g++,document.querySelector(".js_btn").innerHTML="読み込み中..."}));const y=n=>{const a={category:localStorage.getItem("category_id"),click:n};fetch("/src/fetch/getDataByScroll.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("サーバーエラーが発生しました。");return e.json()})).then((e=>{e.length<=0?document.querySelector(".js_btn").innerHTML="全て読み込まれました":document.querySelector(".js_btn").innerHTML="もっと表示させる",(e=>{const t=document.querySelector(".js_table");e.forEach((e=>{let n=null==e.copy?"":(e=>{let t="";return e.forEach((e=>{let n=null==e.directory?"":_(e.directory);const a="0"===e.is_active?"red":"green",o="0"===e.is_active?"未使用":"使用",d="0"==e.random_domain_id?e.tag_reference_randomID:e.random_domain_id,i=`/showTag/?id=${e.id}`;t+=`<tr class="js_copySites">\n            <td class="domain_name align-middle"style="padding-left: 3%;"><img src="/public/img/copy1.png" alt="" class="copy_icon"><a href="${i}" class="textdecoration_none">${e.domain_name}</a></td>\n            <td class="original_check align-middle"></td>\n            <td class="align-middle ${a}">${o}</td>\n            <td class="text_color align-middle">${d}</td>\n            <td class="text_color align-middle edit_modal_btns js_tables" data-id="${e.id}" data-id-active=${e.is_active}><i class="fas fa-ellipsis-v text_color"></i></td>                                 \n        </tr>\n        ${n}\n\n        `})),t})(e.copy),a=null==e.directory?"":(e=>{let t="";return e.forEach((e=>{const n="0"===e.is_active?"red":"green",a="0"===e.is_active?"未使用":"使用",o="0"==e.random_domain_id?e.tag_reference_randomID:e.random_domain_id,d=`/showTag/?id=${e.id}`;t+=`<tr class="js_copySites">\n            <td class="domain_name align-middle" style="padding-left: 3%;"><img src="/public/img/folder.png" alt="" class="folder_icon"><a href="${d}" class="textdecoration_none">${e.domain_name}</a></td>\n            <td class="original_check align-middle"></td>\n            <td class="align-middle ${n}">${a}</td>\n            <td class="text_color align-middle">${o}</td>\n            <td class="text_color align-middle edit_modal_btns js_tables" data-id="${e.id}" data-id-active=${e.is_active}><i class="fas fa-ellipsis-v text_color"></i></td>                                 \n        </tr>`})),t})(e.directory);const o="original"===e.domain_type?"〇":"",d="0"===e.is_active?"red":"green",i="0"===e.is_active?"未使用":"使用",c="original"===e.domain_type?"table-light":"",r="0"==e.random_domain_id?e.tag_reference_randomID:e.random_domain_id,l=`/showTag/?id=${e.id}`,s=`<tbody>\n            <tr class="${c}" data-id=${e.id}>\n                <td class="domain_name align-middle"><a href="${l}" class="textdecoration_none">${e.domain_name}</a></td>\n                <td class="original_check align-middle">${o}</td>\n                <td class="align-middle ${d}">${i}</td>\n                <td class="text_color align-middle">${r}</td>\n                <td class="text_color align-middle edit_modal_btns" data-id="${e.id}" data-id-active=${e.is_active}><i class="fas fa-ellipsis-v text_color"></i></td>                                 \n            </tr>\n            ${a}\n            ${n}\n        </tbody>`;t.insertAdjacentHTML("beforeend",s.trim())}))})(e),s()})).catch((n=>{e(n),t()}))};document.querySelector(".js_search_domain").addEventListener("input",(()=>{document.querySelector(".js_btn ").style.display="none"}))})();