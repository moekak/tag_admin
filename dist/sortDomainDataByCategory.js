(()=>{"use strict";document.getElementById("js_copy_site"),document.getElementById("js_copy_tag"),document.getElementById("tag_reference_id");const e=e=>{const t=`Fetch error: ${e.message}, Detailed error: ${e.stack}, ${new Date}`;fetch("/src/fetch/logErrorFetch.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},t=()=>{window.location.href="/error"};let a={domain_name:"",domain_category:"",domain_type:"",tag_type:"",copy_reference:"",tag_reference:"",copy_reference_id:"",original_domain_id:"null",tag_reference_id:"",domain_id:""};const n=e=>{const t=document.getElementById("js_create_btn"),n=a||o();if("edit"!=e){const e=Boolean(n.domain_name&&n.domain_category&&"original"==n.domain_type&&"new"===n.tag_type),a=Boolean(n.domain_name&&n.domain_category&&"original"==n.domain_type&&"reference"===n.tag_type&&n.tag_reference&&n.tag_reference_id),o=Boolean(n.domain_name&&n.domain_category&&("copy"===n.domain_type||"directory"===n.domain_type)&&"new"===n.tag_type&&n.copy_reference&&n.copy_reference_id&&n.original_domain_id),d=Boolean(n.domain_name&&n.domain_category&&("copy"===n.domain_type||"directory"===n.domain_type)&&"new"!==n.tag_type&&n.copy_reference&&n.copy_reference_id&&n.original_domain_id&&n.tag_reference&&n.tag_reference_id),i=Boolean(n.domain_name&&n.domain_category&&("copy"===n.domain_type||"directory"===n.domain_type)&&"withoutTag"===n.tag_type&&n.copy_reference&&n.copy_reference_id&&n.original_domain_id&&n.tag_reference&&n.tag_reference_id);t.classList.toggle("disabled_btn",!(e||o||d||a||i))}},o=()=>{const e=localStorage.getItem("data");return JSON.parse(e)},d=e=>{e.forEach((e=>{e.checked=!1})),n("add")},i=(e,t,a)=>{e.querySelector(".label").innerHTML=t,e.disabled=!0,document.getElementById(a).value="",n("add")},c=(document.getElementById("js_domain_add_modal"),document.getElementById("js_info_modal"),document.querySelector(".bg-gray")),r=(document.querySelector(".bg-gray2"),document.querySelector(".admin_modal_container")),l=e=>{const t=document.querySelectorAll(".js_selectedID"),o=document.querySelector(".js_isActive");document.getElementById("js_error").innerHTML="",a.copy_reference="",a.copy_reference_id="",a.original_domain_id="",n("add"),""===document.getElementById("js_error").innerHTML&&((()=>{const e=document.getElementById("domain_name"),t=document.querySelectorAll('input[name="type"]'),a=document.querySelectorAll('input[name="category"]'),n=document.querySelectorAll('input[name="tag_types"]'),o=document.getElementById("js_copy_site"),c=document.getElementById("js_copy_tag"),r=document.querySelectorAll(".js_tagCheck");e.value="",d(t),d(a),d(n),d(r),i(o,"コピーサイト参照先","js_copy_reference_id"),i(c,"タグ参照先","js_tag_reference_id"),document.querySelector(".cateogory_area").style.display="none";const l=document.querySelector(".tagInfo_area");"none"==l.style.display&&(l.style.display="block")})(),a.copy_reference="",a.copy_reference_id="",a.original_domain_id="",a.domain_category="",a.domain_name="",a.domain_type="",a.tag_reference="",a.tag_reference_id="",a.tag_type="",n("add")),n("add");let c=e.currentTarget,r=c.getAttribute("data-id");t.forEach((e=>{e.value=r})),o.value=c.getAttribute("data-id-active")},s=()=>{document.querySelectorAll(".edit_modal_btns").forEach((a=>{a.addEventListener("click",(a=>{l(a),(()=>{const a=document.querySelector(".js_selectedID").value;fetch("/src/fetch/checkTagID.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("サーバーエラーが発生しました。");return e.json()})).then((e=>{const t=document.querySelector(".js_delete_tag").getElementsByTagName("p");if(e.length<=0){for(var a=0;a<t.length;a++)t[a].classList.remove("red"),t[a].style.color="rgba(255, 0, 0, 0.25)";const e=document.querySelector(".js_delete_tag").getElementsByTagName("img");for(a=0;a<e.length;a++)e[a].src="/public/img/trash_2.png";document.querySelector(".js_delete_tag").style.pointerEvents="none"}else{for(a=0;a<t.length;a++)t[a].style.color="red";const e=document.querySelector(".js_delete_tag").getElementsByTagName("img");for(a=0;a<e.length;a++)e[a].src="/public/img/trash.png";document.querySelector(".js_delete_tag").style.pointerEvents="auto"}})).catch((a=>{e(a),t()}))})(),(()=>{const a=document.querySelector(".js_selectedID").value;fetch("/src/fetch/checkCopySite.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("サーバーエラーが発生しました。");return e.json()})).then((e=>{e.length>0?(()=>{const e=document.querySelector(".js_delete_domain");e.getElementsByTagName("p")[0].classList.remove("red"),e.getElementsByTagName("p")[0].style.color="rgba(255, 0, 0, 0.25)",e.getElementsByTagName("img")[0].src="/public/img/trash_2.png"})():(()=>{const e=document.querySelector(".js_delete_domain");e.getElementsByTagName("p")[0].classList.add("red"),e.getElementsByTagName("p")[0].style.color="red",e.getElementsByTagName("img")[0].src="/public/img/trash.png"})()})).catch((a=>{e(a),t()}))})(),"0"===document.querySelector(".js_isActive").value?(document.getElementById("active_check").innerHTML="使用する",document.getElementById("active_status").value="使用する"):document.getElementById("active_status").value="使用しない",setTimeout((()=>{r.classList.remove("hidden"),c.classList.remove("hidden")}),100)}))}))},_=e=>{const t=document.querySelector(".js_table");t.innerHTML="";t.insertAdjacentHTML("beforeend",' <thead style="position: sticky; top: 0;" id="js_table">\n            <tr>\n                <th scope="col">ドメイン名</th>\n                <th scope="col">オリジナルLP</th>\n                <th scope="col">ステータス</th>\n                <th scope="col">ドメインID</th>\n                <th></th>\n            </tr>\n        </thead>'.trim()),e.forEach((e=>{let a=null==e.copy?"":m(e.copy),n=null==e.directory?"":y(e.directory);const o="original"===e.domain_type?"〇":"",d="0"===e.is_active?"red":"green",i="0"===e.is_active?"未使用":"使用",c="original"===e.domain_type?"table-light":"",r="0"==e.random_domain_id?e.tag_reference_randomID:e.random_domain_id,l=`/showTag/?id=${e.id}`,s=`<tbody>\n            <tr class="${c}" data-id=${e.id}>\n                <td class="domain_name align-middle"><a href="${l}" class="textdecoration_none">${e.domain_name}</a></td>\n                <td class="original_check align-middle">${o}</td>\n                <td class="align-middle ${d}">${i}</td>\n                <td class="text_color align-middle">${r}</td>\n                <td class="text_color align-middle edit_modal_btns" data-id="${e.id}" data-id-active=${e.is_active}><i class="fas fa-ellipsis-v text_color"></i></td>                                 \n            </tr>\n            ${n}\n            ${a}\n        </tbody>`;t.insertAdjacentHTML("beforeend",s.trim())}))},m=e=>{let t="";return e.forEach((e=>{let a=null==e.directory?"":g(e.directory);const n="0"===e.is_active?"red":"green",o="0"===e.is_active?"未使用":"使用",d="0"==e.random_domain_id?e.tag_reference_randomID:e.random_domain_id,i=`/showTag/?id=${e.id}`;t+=`<tr class="js_copySites">\n            <td class="domain_name align-middle"style="padding-left: 3%;"><img src="/public/img/copy1.png" alt="" class="copy_icon"><a href="${i}" class="textdecoration_none">${e.domain_name}</a></td>\n            <td class="original_check align-middle"></td>\n            <td class="align-middle ${n}">${o}</td>\n            <td class="text_color align-middle">${d}</td>\n            <td class="text_color align-middle edit_modal_btns js_tables" data-id="${e.id}" data-id-active=${e.is_active}><i class="fas fa-ellipsis-v text_color"></i></td>                                 \n        </tr>\n        ${a}\n\n        `})),t},g=e=>{let t="";return e.forEach((e=>{const a="0"===e.is_active?"red":"green",n="0"===e.is_active?"未使用":"使用",o="0"==e.random_domain_id?e.tag_reference_randomID:e.random_domain_id,d=`/showTag/?id=${e.id}`;t+=`<tr class="js_copySites">\n            <td class="domain_name align-middle" style="padding-left: 8%;"><img src="/public/img/folder.png" alt="" class="folder_icon"><a href="${d}" class="textdecoration_none">${e.domain_name}</a></td>\n            <td class="original_check align-middle"></td>\n            <td class="align-middle ${a}">${n}</td>\n            <td class="text_color align-middle">${o}</td>\n            <td class="text_color align-middle edit_modal_btns js_tables" data-id="${e.id}" data-id-active=${e.is_active}><i class="fas fa-ellipsis-v text_color"></i></td>                                 \n        </tr>\n        `})),t},y=e=>{let t="";return e.forEach((e=>{const a="0"===e.is_active?"red":"green",n="0"===e.is_active?"未使用":"使用",o="0"==e.random_domain_id?e.tag_reference_randomID:e.random_domain_id,d=`/showTag/?id=${e.id}`;t+=`<tr class="js_copySites">\n            <td class="domain_name align-middle" style="padding-left: 3%;"><img src="/public/img/folder.png" alt="" class="folder_icon"><a href="${d}" class="textdecoration_none">${e.domain_name}</a></td>\n            <td class="original_check align-middle"></td>\n            <td class="align-middle ${a}">${n}</td>\n            <td class="text_color align-middle">${o}</td>\n            <td class="text_color align-middle edit_modal_btns js_tables" data-id="${e.id}" data-id-active=${e.is_active}><i class="fas fa-ellipsis-v text_color"></i></td>                                 \n        </tr>`})),t};document.querySelectorAll(".js_categories").forEach((a=>{a.addEventListener("click",(a=>{document.querySelector(".js_search_domain").value="",document.querySelector(".js_btn ").style.display="block";let n=a.target.getAttribute("data-category-id");var o;o=n,localStorage.setItem("category_id",o),(e=>{document.querySelectorAll(".js_categories").forEach((t=>{t.getAttribute("data-category-id")===e?t.classList.add("active"):t.classList.remove("active")}))})(localStorage.getItem("category_id")),"all"===n?fetch("/src/fetch/getDomainInfoAll.php",{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>{if(!e.ok)throw new Error("サーバーエラーが発生しました。");return e.json()})).then((e=>{_(e),s()})).catch((a=>{e(a),t()})):(a=>{fetch("/src/fetch/sortDomainDataByCategory.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("サーバーエラーが発生しました。");return e.json()})).then((e=>{_(e),s()})).catch((a=>{e(a),t()}))})(n)}))}))})();